<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathlink Masters</title>
    <!-- Use Tailwind CSS for easy styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(to bottom, #d1d5db, #6b7280);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }

        .container {
            max-width: 960px;
            width: 100%;
            background-color: white;
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .design-card {
            border: 2px solid #e5e7eb;
            border-radius: 1rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%; /* Ensure consistent height */
        }

        .design-card:hover {
            border-color: #6366f1;
            transform: translateY(-5px);
            box-shadow: 0 5px 10px rgba(99, 102, 241, 0.2);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: white;
            padding: 2.5rem;
            border-radius: 1.5rem;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .timer-text.red-minute {
            color: #ef4444; /* Tailwind's red-500 */
            font-weight: bold;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .design-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body class="bg-gray-200 flex items-center justify-center min-h-screen p-4">

<div class="container" id="main-container">

    <!-- Start Screen -->
    <div id="start-screen" class="space-y-8">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-2">Mathlink Masters</h1>
        <p class="text-gray-600 max-w-lg mx-auto">
            Welcome, Mathlink Master! Select a time limit and a design to begin your challenge.
        </p>

        <div class="flex flex-col md:flex-row items-center justify-center gap-4 mb-8">
            <label for="timer-input" class="text-lg font-medium text-gray-700">Set Timer (minutes):</label>
            <input type="number" id="timer-input" value="3" min="1" class="w-24 p-2 text-center border-2 border-gray-300 rounded-lg focus:outline-none focus:border-indigo-500">
        </div>

        <h2 class="text-2xl font-bold text-gray-800 mb-6">Choose Your Design</h2>
        
        <div id="design-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <!-- Design cards will be dynamically inserted here -->
        </div>

        <p class="text-sm text-gray-500 mt-8">Click any design to start the challenge.</p>
    </div>

    <!-- Game Screen -->
    <div id="game-screen" class="hidden">
        <h2 class="text-3xl font-bold text-gray-800 mb-4">Your Challenge</h2>
        <p class="text-gray-600 mb-6">Build this design before the time runs out!</p>
        <div class="flex justify-center items-center mb-6">
            <div id="current-design-display" class="w-64 h-64 border-4 border-gray-300 rounded-xl p-4 flex items-center justify-center bg-gray-50">
                <!-- Selected design will be inserted here -->
            </div>
        </div>
        <div id="timer-display" class="text-6xl font-mono text-gray-900 mb-8">
            03:00
        </div>
    </div>

    <!-- Pop-up Modal -->
    <div id="modal-overlay" class="modal-overlay hidden">
        <div id="modal-content" class="modal-content">
            <!-- Modal content will be dynamically updated here -->
        </div>
    </div>

</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DOM Elements ---
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const modalOverlay = document.getElementById('modal-overlay');
        const modalContent = document.getElementById('modal-content');
        const designGrid = document.getElementById('design-grid');
        const timerInput = document.getElementById('timer-input');
        const timerDisplay = document.getElementById('timer-display');
        const currentDesignDisplay = document.getElementById('current-design-display');
        
        // --- Game State Variables ---
        let timerInterval;
        let selectedDesign = null;
        let initialTimerValue = 3; // Default to 3 minutes

        // --- Design Bank of Ideas (Note: A full bank would be 124 items) ---
        const designBank = [
            // Shapes
            { name: "Square", svg: `<svg class="w-full h-full text-blue-500" viewBox="0 0 100 100"><rect x="10" y="10" width="80" height="80" rx="10" stroke="#3b82f6" stroke-width="5" fill="none" /></svg>` },
            { name: "Triangle", svg: `<svg class="w-full h-full text-green-500" viewBox="0 0 100 100"><polygon points="50,10 90,90 10,90" stroke="#22c55e" stroke-width="5" fill="none" /></svg>` },
            { name: "Circle", svg: `<svg class="w-full h-full text-purple-500" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" stroke="#a855f7" stroke-width="5" fill="none" /></svg>` },
            { name: "Hexagon", svg: `<svg class="w-full h-full text-indigo-500" viewBox="0 0 100 100"><polygon points="50,10 90,30 90,70 50,90 10,70 10,30" stroke="#6366f1" stroke-width="5" fill="none" /></svg>` },
            { name: "Star", svg: `<svg class="w-full h-full text-yellow-500" viewBox="0 0 100 100"><polygon points="50,5 61,39 98,39 68,61 79,98 50,75 21,98 32,61 2,39 39,39" stroke="#eab308" stroke-width="5" fill="none" /></svg>` },
            // Animals
            { name: "Cat", svg: `<svg class="w-full h-full text-gray-600" viewBox="0 0 100 100"><path d="M20,60 C20,20 80,20 80,60 C80,80 60,90 50,90 C40,90 20,80 20,60 Z M35,45 L35,55 M65,45 L65,55" stroke="#4b5563" stroke-width="3" fill="none" /></svg>` },
            { name: "Bird", svg: `<svg class="w-full h-full text-sky-500" viewBox="0 0 100 100"><path d="M10,50 Q40,10 50,50 Q60,10 90,50 L80,60 L20,60 Z" stroke="#0ea5e9" stroke-width="3" fill="none" /></svg>` },
            { name: "Fish", svg: `<svg class="w-full h-full text-cyan-500" viewBox="0 0 100 100"><path d="M20,50 C40,20 80,30 80,50 C80,70 40,80 20,50 Z M80,50 L90,40 M80,50 L90,60" stroke="#06b6d4" stroke-width="3" fill="none" /></svg>` },
            // Numberblocks (represented visually as blocks with numbers)
            { name: "Numberblock 1", svg: `<div class="bg-red-500 w-20 h-20 text-white font-bold text-4xl flex items-center justify-center rounded-lg shadow-md">1</div>` },
            { name: "Numberblock 2", svg: `<div class="bg-orange-500 w-20 h-40 text-white font-bold text-4xl flex items-center justify-center rounded-lg shadow-md">2</div>` },
            { name: "Numberblock 3", svg: `<div class="bg-yellow-500 w-20 h-60 text-white font-bold text-4xl flex items-center justify-center rounded-lg shadow-md">3</div>` },
            { name: "Numberblock 4", svg: `<div class="bg-green-500 w-40 h-40 text-white font-bold text-4xl flex flex-wrap items-center justify-center rounded-lg shadow-md"><div class="w-1/2 h-1/2 flex items-center justify-center"></div><div class="w-1/2 h-1/2 flex items-center justify-center"></div><div class="w-1/2 h-1/2 flex items-center justify-center"></div><div class="w-1/2 h-1/2 flex items-center justify-center">4</div></div>` },
        ];

        // --- Functions ---

        // Function to shuffle and select 4 unique random designs
        const getRandomDesigns = () => {
            const shuffled = [...designBank].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, 4);
        };

        // Function to render the start screen
        const renderStartScreen = () => {
            startScreen.classList.remove('hidden');
            gameScreen.classList.add('hidden');
            modalOverlay.classList.add('hidden');
            designGrid.innerHTML = ''; // Clear previous designs

            const designs = getRandomDesigns();
            designs.forEach((design, index) => {
                const card = document.createElement('div');
                card.className = 'design-card p-4 rounded-xl border-4 border-gray-300 hover:border-indigo-500 transition-all cursor-pointer shadow-md';
                card.innerHTML = `
                    <div class="h-40 w-40 flex items-center justify-center mx-auto mb-4">
                        ${design.svg}
                    </div>
                    <p class="text-xl font-semibold text-gray-800">${design.name}</p>
                `;
                card.addEventListener('click', () => startGame(design));
                designGrid.appendChild(card);
            });
        };

        // Function to start the game
        const startGame = (design) => {
            selectedDesign = design;
            const minutes = parseInt(timerInput.value, 10);
            initialTimerValue = isNaN(minutes) || minutes < 1 ? 3 : minutes;
            let timeInSeconds = initialTimerValue * 60;

            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');

            // Display the selected design
            currentDesignDisplay.innerHTML = selectedDesign.svg;

            // Start the timer
            timerInterval = setInterval(() => {
                timeInSeconds--;
                const minutesLeft = Math.floor(timeInSeconds / 60);
                const secondsLeft = timeInSeconds % 60;

                const formattedTime = `${String(minutesLeft).padStart(2, '0')}:${String(secondsLeft).padStart(2, '0')}`;
                timerDisplay.textContent = formattedTime;

                // Make timer red for the last minute
                if (timeInSeconds <= 60) {
                    timerDisplay.classList.add('red-minute');
                } else {
                    timerDisplay.classList.remove('red-minute');
                }

                if (timeInSeconds <= 0) {
                    clearInterval(timerInterval);
                    showPopup('endOfTime');
                }
            }, 1000);
        };

        // Function to show the popup modal
        const showPopup = (type) => {
            gameScreen.classList.add('hidden');
            modalOverlay.classList.remove('hidden');

            if (type === 'endOfTime') {
                modalContent.innerHTML = `
                    <h3 class="text-2xl font-bold mb-4">Time's Up!</h3>
                    <p class="mb-6">Did you manage to make the design?</p>
                    <div class="flex justify-center gap-4">
                        <button id="yes-btn" class="bg-green-500 text-white py-2 px-6 rounded-lg font-semibold hover:bg-green-600 transition-colors">Yes</button>
                        <button id="no-btn" class="bg-red-500 text-white py-2 px-6 rounded-lg font-semibold hover:bg-red-600 transition-colors">No</button>
                    </div>
                `;
                document.getElementById('yes-btn').addEventListener('click', () => showPopup('congratulations'));
                document.getElementById('no-btn').addEventListener('click', () => {
                    modalOverlay.classList.add('hidden');
                    // Restart with the same design and 3 more minutes
                    startGame(selectedDesign);
                    timerInput.value = 3;
                });
            } else if (type === 'congratulations') {
                modalContent.innerHTML = `
                    <h3 class="text-2xl font-bold mb-4">Congratulations!</h3>
                    <p class="mb-4">You have earned the golden mathlink cube!</p>
                    <div class="flex justify-center mb-6">
                        <svg class="w-48 h-48 text-yellow-400 animate-pulse" viewBox="0 0 100 100">
                            <rect x="10" y="10" width="80" height="80" rx="15" stroke="currentColor" stroke-width="5" fill="none" class="animate-spin-slow" />
                            <rect x="25" y="25" width="50" height="50" rx="10" fill="currentColor" />
                            <polygon points="50,20 70,80 30,80" fill="white" opacity="0.8" class="animate-bounce" />
                        </svg>
                    </div>
                    <button id="reset-btn" class="bg-indigo-500 text-white py-2 px-6 rounded-lg font-semibold hover:bg-indigo-600 transition-colors">Reset</button>
                `;
                document.getElementById('reset-btn').addEventListener('click', renderStartScreen);
            }
        };
        
        // --- Initialize the game on load ---
        renderStartScreen();
    });
</script>

</body>
</html>
